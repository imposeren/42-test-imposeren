{% extends "base.html" %}
{% load url from future %}
{% block extra_head %}
    <link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}css/profile.css">
{% endblock %}

{% block extra_header %}
    <div style="float: right;">
    {% if user.is_authenticated %}
        Logged in as «{{ user }}»
        (<a href="{% url 'django.contrib.auth.views.logout' %}?next={% url 'profiles.views.edit' %}">Logout</a>)
    {% else %}
        <a href="{% url 'django.contrib.auth.views.login' %}?next={% url 'profiles.views.edit' %}">Login</a>
    {% endif %}
    </div>
{% endblock %}

{% block content %}
<form method="post" action="" enctype="multipart/form-data">
    {% csrf_token %}
    <table class="profile">
    <tr><th></th><th>Contacts</th></tr>
    <tr>
        <td>
            <table class="profile">{{ profile.as_table }}</table>
        </td>
        <td>
            {{ contacts.management_form }}
            <table class="profile">
                {% for form in contacts %}
                    {{ form.id }}
                    {% if form.mean.value %}
                        {{ form.mean.as_hidden }} 
                        {{ form.mean.value }}: {{ form.data }}
                        . Delete {{ form.DELETE }}
                    {% else %}
                        {{ form.mean }}: {{ form.data }}
                    {% endif %}
                    <br />
                {% endfor %}
            </table>
        </td>
    </tr>
    </table>
    <p><input name="submit" type="submit" value="Save"> <a href="/">Cancel</a></p>
{% if errors %}
    Errors in form:
    {% for error in errors %}
        {{ error }}
    {% endfor %}
{% endif %}
</form>
{% endblock %}