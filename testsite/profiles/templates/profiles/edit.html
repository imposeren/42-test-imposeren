{% extends "base.html" %}
{% load url from future %}
{% block extra_head %}
    <link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}css/profile.css">
{% endblock %}

{% block extra_header %}
    <div style="float: right;">
    {% if user.is_authenticated %}
        Logged in as «{{ user }}»
        (<a href="{% url 'django.contrib.auth.views.logout' %}?next={% url 'profiles.views.edit' %}">Logout</a>)
    {% else %}
        <a href="{% url 'django.contrib.auth.views.login' %}?next={% url 'profiles.views.edit' %}">Login</a>
    {% endif %}
    </div>
{% endblock %}

{% block content %}
<form method="post" action="" enctype="multipart/form-data">
    {% csrf_token %}
    <table>
    <tr><th></th><th>Contacts</th></tr>
    <tr>
        <td class="profile">
            <table>
                {% comment %} {{ profile.as_table }} {% endcomment %}
                {% for field in profile %}
                    {% if field.label != "Bio" %}
                    <tr>
                    <td>{{ field.errors }}
                    {{ field.label_tag }}:</td><td> {{ field }}</td>
                    </tr>
                    {% endif %}
                {% endfor %}
            </table>
        </td>
        <td>
            {{ contacts.management_form }}
            <table class="subtable">
                {% for form in contacts %}
                    <tr>
                    {{ form.id }}
                    {% if form.mean.value %}
                        {{ form.mean.as_hidden }}
                        <td>{{ form.mean.value }}</td><td>{{ form.data }}</td>
                        <td>Delete {{ form.DELETE }}</td>
                    {% else %}
                        <td>{{ form.mean }}</td><td>{{ form.data }}</td><td></td>
                    {% endif %}
                    </tr>
                {% endfor %}
                <tr>
                    <td>{{ field.errors }}
                    {{ profile.bio.label_tag }}:</td><td> {{ profile.bio }}</td><td></td>
                </tr>
            </table>
        </td>
    </tr>
    </table>
    <p><input name="submit" type="submit" value="Save"> <a href="/">Cancel</a></p>
{% if errors %}
    Errors in form:
    {% for error in errors %}
        {{ error }}
    {% endfor %}
{% endif %}
</form>
{% endblock %}